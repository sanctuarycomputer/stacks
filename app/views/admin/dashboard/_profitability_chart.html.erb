<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/chart.js@2.9.1/dist/Chart.min.css">
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.1/dist/Chart.min.js"></script>

<style>
.dashboard-modules {
  display: flex;
}
.dashboard-module {
  width: 100%;
  box-shadow: 0 1px 20px #b7b7b7;
  border-radius: 8px;
}
.dashboard-module:nth-child(even) {
  margin-left: 10px;
}
.dashboard-module:nth-child(odd) {
  margin-right: 10px;
}
.dashboard-module .module-header {
  padding: 20px;
  display: flex;
  justify-content: space-between;
  border-bottom: 1px dashed #e8e8e8;
}

.dashboard-module .module-header p {
  font-size: 18px;
  font-weight: 700;
  margin-bottom: 0;
  color: #5E6469;
}
.dashboard-module .module-body {
  padding: 20px;
}
</style>

<div class="dashboard-modules table index_table index">
  <div class="dashboard-module">
    <div class="module-header">
      <p>Profitability (%)</p>
      <p><a href="?profitability-time-span=3-months">3 Months</a></p>
      <p><a href="?profitability-time-span=6-months">6 Months</a></p>
      <p><a href="?profitability-time-span=all-time">All Time</a></p>
    </div>
    <div class="module-body">
      <canvas id="profitability-chart" width="500" height="500"></canvas>
    </div>
  </div>

  <!--
  <div class="dashboard-module">
    <div class="module-header">
      <p>PSU Projection</p>
      <p><a>Read More â†’</a></p>
    </div>
    <div class="module-body">
      <p>hello</p>
    </div>
    </div>
  -->
</div>

<script>
  new Chart(document.getElementById('profitability-chart'), {
    type: 'line',
    data: <%= data.to_json.html_safe %>,
    options: {
      showLines: true,
      scales: {
        yAxes: [{
          ticks: {
            min: -100,
            max: 100,
            stepSize: 20,
            callback: function (value) {
              return (value / this.max * 100).toFixed(0) + '%'; // convert it to percentage
            },
          },
          type: "linear",
          display: true,
          position: "left",
          gridLines: {
            drawOnArea: false,
          },
        }],
      },
      responsive: true,
      maintainAspectRatio: false,
    }
  });
</script>
